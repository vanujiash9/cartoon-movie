<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>Chi ti·∫øt phim - MAXION</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="./movie_detail.css">
    <link rel="stylesheet" href="../header.css"> <!-- Add header CSS -->
    <link rel="stylesheet" href="../css/notifications.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Emergency fallback styles */
        :root {
            --bg-color: #1a1a1a;
            --text-color: #ffffff;
            --text-secondary: #cccccc;
            --primary-color: #3498db;
            --bg-secondary: #2c2c2c;
            --light-color: #444444;
        }
          body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }
        
        /* Header styles - essential for inline header */
        header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            height: 80px;
            background: rgba(34, 35, 40, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(52, 152, 219, 0.2);
        }
        
        .navbar {
            height: 80px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            max-width: 100%;
            box-sizing: border-box;
        }        /* Header styles - essential for inline header */
        header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            height: 80px;
            background: rgba(34, 35, 40, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(52, 152, 219, 0.2);
        }
        
        .navbar {
            height: 80px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            max-width: 100%;
            box-sizing: border-box;
        }
        
        .movie-detail-hero {
            position: relative;
            width: 100%;
            height: 60vh;
            overflow: hidden;
            background: linear-gradient(135deg, #2c3e50, #3498db);
            margin-top: 80px; /* Match header height exactly */
        }
        
        .movie-detail-hero-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .movie-detail-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
            padding: 2rem;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .movie-info-grid {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 2rem;
            margin-top: -150px;
            position: relative;
            z-index: 2;
        }
        
        .movie-poster-container {
            position: relative;
        }
        
        .movie-poster-lg {
            width: 100%;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        
        .play-trailer-btn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60px;
            height: 60px;
            background: rgba(52, 152, 219, 0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .play-trailer-btn:hover {
            background: rgba(52, 152, 219, 1);
            transform: translate(-50%, -50%) scale(1.1);
        }
        
        .movie-info-main h1 {
            font-size: 2.5rem;
            margin: 0 0 1rem 0;
            color: var(--text-color);
        }
        
        .movie-meta-info {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        
        .movie-meta-info span {
            background: var(--bg-secondary);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .movie-rating {
            margin-bottom: 2rem;
        }
        
        .stars {
            color: #f39c12;
            margin-right: 10px;
        }
        
        .action-buttons {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            font-weight: 500;
            transition: all 0.3s ease;
            font-size: 1rem;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-outline {
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
            background: transparent;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        
        .btn-primary:hover {
            background: #2980b9;
        }
        
        .btn-outline:hover {
            background: var(--primary-color);
            color: white;
        }
        
        .tabs {
            display: flex;
            gap: 1rem;
            margin: 2rem 0;
            border-bottom: 2px solid var(--bg-secondary);
        }
        
        .tab {
            padding: 1rem 1.5rem;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
            color: var(--text-secondary);
        }
        
        .tab.active {
            border-bottom-color: var(--primary-color);
            color: var(--primary-color);
        }
        
        .tab:hover {
            color: var(--text-color);
        }
        
        .tab-content {
            display: none;
            margin-top: 2rem;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .category-item {
            display: inline-block;
            background: var(--primary-color);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            margin: 5px;
            font-size: 0.9rem;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: var(--bg-secondary);
            padding: 2rem;
            border-radius: 10px;
            position: relative;
            max-width: 90%;
            max-height: 90%;
        }
        
        .close-btn, .close {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            z-index: 10001;
        }
        
        .close-btn:hover, .close:hover {
            color: var(--primary-color);
        }
        
        /* Loading spinner */
        .loading-spinner {
            border: 4px solid var(--bg-secondary);
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Community section styles */
        .community-section {
            background: var(--bg-color);
            padding: 3rem 0;
        }
        
        .section-title h2 {
            text-align: center;
            margin-bottom: 2rem;
            color: var(--text-color);
        }
          /* Responsive design */
        @media (max-width: 768px) {
            .movie-info-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
                margin-top: -50px;
            }
            
            .movie-info-main h1 {
                font-size: 1.8rem;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                text-align: center;
            }
            
            .tabs {
                overflow-x: auto;
                scrollbar-width: none;
                -ms-overflow-style: none;
            }
            
            .tabs::-webkit-scrollbar {
                display: none;
            }
            
            /* Mobile header adjustments */
            .movie-detail-hero {
                margin-top: 60px !important; /* Mobile header is typically smaller */
            }
            
            #header-iframe {
                height: 60px;
                min-height: 60px;
            }
        }
        
        @media (max-width: 480px) {
            .movie-detail-overlay {
                padding: 1rem;
            }
            
            .movie-detail-overlay h1 {
                font-size: 2rem !important;
            }
            
            .container {
                padding: 0 10px;
            }
        }
        
        /* Additional header styles for full functionality */
        .navbar-brand img {
            width: 140px;
            height: auto;
            filter: drop-shadow(0 2px 8px rgba(52, 152, 219, 0.3));
            transition: all 0.3s ease;
        }
        
        .navbar-brand:hover img {
            filter: drop-shadow(0 2px 12px rgba(52, 152, 219, 0.5));
            transform: scale(1.05);
        }
        
        .navbar-nav {
            display: flex;
            gap: 20px;
            align-items: center;
            list-style: none;
            margin: 0;
            padding: 0;
        }
        
        .navbar-link {
            color: var(--text-color);
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .navbar-link:hover {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
        }
        
        .navbar-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .navbar-form {
            position: relative;
            display: flex;
            align-items: center;
        }
        
        .navbar-form-search {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(52, 152, 219, 0.3);
            border-radius: 25px;
            padding: 10px 40px 10px 20px;
            color: var(--text-color);
            font-size: 14px;
            width: 250px;
            transition: all 0.3s ease;
        }
        
        .navbar-form-search:focus {
            outline: none;
            border-color: #3498db;
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        
        .navbar-form-btn, .voice-btn {
            background: none;
            border: none;
            color: var(--text-color);
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .navbar-form-btn:hover, .voice-btn:hover {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
        }
        
        .navbar-signin {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .navbar-signin:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }
        
        .user-menu {
            position: relative;
        }
        
        .user-info-display {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 8px 16px;
            border-radius: 25px;
            transition: all 0.3s ease;
        }
        
        .user-info-display:hover {
            background: rgba(52, 152, 219, 0.1);
        }
        
        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
        }
        
        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--bg-secondary);
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            min-width: 200px;
            display: none;
            z-index: 1001;
        }
        
        .dropdown-item {
            padding: 12px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }
        
        .dropdown-item:hover {
            background: rgba(52, 152, 219, 0.1);
        }
        
        /* Notification styles */
        .notification-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            min-width: 300px;
            max-width: 400px;
            z-index: 1001;
            opacity: 1;
            transform: translateY(0);
            transition: all 0.3s ease;
        }
        
        .notification-dropdown-hidden {
            opacity: 0;
            transform: translateY(-10px);
            pointer-events: none;
        }
          .search-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: none;
            z-index: 1001;
        }
        
        /* Community Discussion Styles */
        .comments-container {
            max-width: 100%;
        }
        
        .comment {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .comment-main {
            display: flex;
            gap: 15px;
        }
        
        .comment-avatar {
            flex-shrink: 0;
        }
        
        .avatar-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), #2980b9);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
        }
        
        .avatar-circle.small {
            width: 32px;
            height: 32px;
            font-size: 12px;
        }
        
        .comment-content {
            flex: 1;
        }
        
        .comment-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .comment-author {
            font-weight: 600;
            color: var(--text-color);
        }
        
        .comment-time {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .comment-rating {
            color: #ffd700;
            font-size: 0.9rem;
        }
        
        .comment-text {
            color: var(--text-color);
            line-height: 1.6;
            margin-bottom: 15px;
        }
        
        .comment-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .action-btn {
            background: none;
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-secondary);
            padding: 6px 12px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .action-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-color);
        }
        
        .action-btn.active {
            border-color: var(--primary-color);
            color: var(--primary-color);
            background: rgba(52, 152, 219, 0.1);
        }
        
        .like-btn.active {
            border-color: #27ae60;
            color: #27ae60;
            background: rgba(39, 174, 96, 0.1);
        }
        
        .dislike-btn.active {
            border-color: #e74c3c;
            color: #e74c3c;
            background: rgba(231, 76, 60, 0.1);
        }
        
        .delete-btn:hover {
            border-color: #e74c3c;
            color: #e74c3c;
        }
        
        .comment-replies {
            margin-left: 55px;
            margin-top: 20px;
            border-left: 2px solid rgba(255, 255, 255, 0.1);
            padding-left: 20px;
        }
        
        .comment-reply {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }
        
        .reply-form-container {
            margin-left: 55px;
            margin-top: 15px;
        }
        
        .reply-form {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
        }
        
        .reply-form textarea {
            width: 100%;
            background: var(--bg-color);
            border: 1px solid var(--light-color);
            border-radius: 5px;
            padding: 10px;
            color: var(--text-color);
            resize: vertical;
            min-height: 80px;
            margin-bottom: 10px;
            box-sizing: border-box;
        }
        
        .reply-form-actions {
            display: flex;
            gap: 10px;
        }
        
        .submit-reply-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
        }
        
        .cancel-reply-btn {
            background: none;
            color: var(--text-secondary);
            border: 1px solid var(--light-color);
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .no-comments {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
        }
        
        .no-comments i {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.5;
        }
        
        .comments-error {
            text-align: center;
            padding: 30px 20px;
            color: #e74c3c;
        }
        
        .retry-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 15px;
        }
        
        .star-rating label span:hover,
        .star-rating label:hover ~ label span {
            color: #ffd700 !important;
        }
        
        .star-rating input:checked ~ label span {
            color: #ffd700 !important;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Mobile responsiveness for comments */
        @media (max-width: 768px) {
            .comment-main {
                gap: 10px;
            }
            
            .comment {
                padding: 15px;
            }
            
            .comment-replies {
                margin-left: 35px;
                padding-left: 15px;
            }
            
            .reply-form-container {
                margin-left: 35px;
            }
            
            .comment-actions {
                gap: 10px;
                flex-wrap: wrap;
            }
            
            .action-btn {
                font-size: 0.8rem;
                padding: 5px 10px;
            }
        }
        
        /* ...existing code... */
    </style>
</head>
<body class="dark-mode"> <!-- Default to dark-mode, script.js might handle theme preference -->     <!-- Header Include -->
    <header>
        <div class="navbar" id="navbar">            <a href="#" class="navbar-brand" onclick="navigateToHome()">
                <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQwIiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMTQwIDQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8dGV4dCB4PSIyMCIgeT0iMjgiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC13ZWlnaHQ9ImJvbGQiIGZvbnQtc2l6ZT0iMjQiIGZpbGw9IiMzNDk4ZGIiPk1heGlvbjwvdGV4dD4KPC9zdmc+"
                    alt="Maxion Logo">
            </a>

            <nav id="navMenu">
                <ul class="navbar-nav">
                    <li><a href="#" class="navbar-link" onclick="smartNavigate('top')">Trang ch·ªß</a></li>
                    <li><a href="#" class="navbar-link" onclick="smartNavigate('movies')">Danh s√°ch phim</a></li>
                    <li><a href="#" class="navbar-link indicator" onclick="smartNavigate('achievements')">Th√†nh t·ª±u</a></li>
                    <li><a href="#" class="navbar-link" onclick="smartNavigate('category')">Th·ªÉ lo·∫°i</a></li>
                    <li><a href="#" class="navbar-link" onclick="smartNavigate('live')">TV Tr·ª±c ti·∫øp</a></li>
                </ul>
            </nav>

            <div class="navbar-actions">
                <form class="navbar-form" id="searchForm">
                    <input type="text" name="search" placeholder="T√¨m ki·∫øm phim..." class="navbar-form-search"
                        id="searchInput">
                    <button type="button" class="navbar-form-btn" id="searchBtn">
                        <span style="font-size: 18px;">üîç</span>
                    </button>
                    <div class="search-suggestions" id="searchSuggestions"></div>
                </form>
                
                <button class="voice-btn" id="voiceBtn" title="T√¨m ki·∫øm b·∫±ng gi·ªçng n√≥i">
                    <span>üé§</span>
                </button>


                <div class="notification-menu" id="notificationMenu" style="position: relative; margin-right: 16px;">
                    <div class="notification-bell-display" id="notificationBellDisplay" style="cursor: pointer;">
                        <span style="font-size: 22px; transition: transform 0.2s;">üîî</span>
                        <span id="notificationBadge"
                            style="position: absolute; top: -4px; right: -4px; background: #ff4757; color: white; border-radius: 50%; font-size: 11px; padding: 2px 6px; display: none; min-width: 18px; text-align: center; font-weight: bold; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">0</span>
                    </div>
                    <div id="notificationDropdown" class="notification-dropdown notification-dropdown-hidden">
                        <div class="notification-header">
                            <span>üîî Th√¥ng b√°o</span>
                            <span id="notificationCount" style="background: rgba(255,255,255,0.2); padding: 2px 8px; border-radius: 12px; font-size: 12px;">0</span>
                        </div>
                        <div id="notificationList" style="max-height: 400px; overflow-y: auto;">
                            <!-- Initial empty state - will be replaced by JS -->
                        </div>
                        <div style="padding: 12px; text-align: center; border-top: 1px solid #eee; background: #f8f9fa;">
                            <a href="#" onclick="markAllNotificationsRead(); return false;"
                                style="color: #667eea; font-size: 14px; text-decoration: none; font-weight: 500; padding: 8px 16px; border-radius: 6px; transition: all 0.2s; display: inline-block;"
                                onmouseover="this.style.background='#667eea'; this.style.color='white';"
                                onmouseout="this.style.background='transparent'; this.style.color='#667eea';">
                                ‚úì ƒê√°nh d·∫•u t·∫•t c·∫£ ƒë√£ ƒë·ªçc
                            </a>
                        </div>
                    </div>                </div><!-- Sign In Button (shown when NOT logged in) -->
                <a href="../login-register/login.html" class="navbar-signin" id="signInBtn">
                    <span id="signInText">ƒêƒÉng nh·∫≠p</span>
                    <span style="margin-left: 8px;">‚û°Ô∏è</span>
                </a>

                <!-- User Menu (shown when logged in) -->
                <div class="user-menu" id="userMenu" style="display: none;">
                    <div class="user-info-display" id="userInfoDisplay">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjAiIGN5PSIyMCIgcj0iMjAiIGZpbGw9IiMzNDk4ZGIiLz4KPHN2ZyB4PSIxMCIgeT0iMTAiIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCI+Cjx0ZXh0IHg9IjEwIiB5PSIxNSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmaWxsPSJ3aGl0ZSI+VTwvdGV4dD4KPC9zdmc+Cjwvc3ZnPg=="
                            alt="User Avatar" class="user-avatar" id="userAvatar">
                        <span class="user-name" id="displayUserName">Ng∆∞·ªùi d√πng</span>
                        <span class="dropdown-arrow">‚ñº</span>
                    </div>
                    <div class="user-dropdown" id="userDropdown">
                        <div class="dropdown-item" onclick="viewProfile()">
                            <span>üë§</span>
                            H·ªì s∆° c·ªßa t√¥i
                        </div>
                        <div class="dropdown-item" onclick="viewBookmarks()">
                            <span>‚ù§Ô∏è</span>
                            Danh s√°ch y√™u th√≠ch
                        </div>
                        <div class="dropdown-item" onclick="viewHistory()">
                            <span>‚è∞</span>
                            L·ªãch s·ª≠ xem
                        </div>
                        <div class="dropdown-item" onclick="logout()">
                            <span>üö™</span>
                            ƒêƒÉng xu·∫•t
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header><!-- Movie Detail Hero -->
    <section class="movie-detail-hero" style="margin-top: 80px;"> <!-- Adjusted margin-top to match header height -->
        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIwMCIgaGVpZ2h0PSI1MDAiIHZpZXdCb3g9IjAgMCAxMjAwIDUwMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjEyMDAiIGhlaWdodD0iNTAwIiBmaWxsPSIjM2M0OGRiIi8+Cjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iNDAiIGZpbGw9IiNmZmZmZmYiIGZvbnQtd2VpZ2h0PSJib2xkIj7EkGFuZyB04bqjaSBwaGltLi4uPC90ZXh0Pgo8L3N2Zz4K" alt="Movie Banner" class="movie-detail-hero-img" id="movie-banner-img">
        <div class="movie-detail-overlay">
            <div class="container">
                <!-- <h1 style="color: white; font-size: 3rem; margin-bottom: 20px;" id="movie-banner-title">ƒêang t·∫£i...</h1> -->
                <!-- <p style="color: white; opacity: 0.9; max-width: 600px; margin-bottom: 30px;" id="movie-banner-description">
                    ƒêang t·∫£i m√¥ t·∫£...
                </p> -->
            </div>
        </div>
    </section>

    <!-- Movie Detail Content -->
    <section class="movie-detail-content">
        <div class="container">
            <div class="movie-info-grid"><div class="movie-poster-container">
                    <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjQ1MCIgdmlld0JveD0iMCAwIDMwMCA0NTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIzMDAiIGhlaWdodD0iNDUwIiBmaWxsPSIjMzQ0OTVlIi8+Cjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjQiIGZpbGw9IiNmZmZmZmYiIGZvbnQtd2VpZ2h0PSJib2xkIj7EkGFuZyB04bqjaSBwb3N0ZXIuLi48L3RleHQ+Cjwvc3ZnPgo=" alt="Movie Poster" class="movie-poster-lg" id="movie-poster-img">
                    <div class="play-trailer-btn">‚ñ∂</div>
                </div>
                <div class="movie-info-main">
                    <h1 id="movie-title">ƒêang t·∫£i...</h1>
                    <div class="movie-meta-info" id="movie-meta-info">
                        <!-- Dynamic content will be injected here by script.js -->
                    </div>
                    <div class="movie-rating">
                        <!-- Rating can be made dynamic later -->
                        <span class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
                        <span>9.2/10</span>
                        <span>(2.5k ƒë√°nh gi√°)</span>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary btn-lg" id="watch-now-btn">‚ñ∂ Xem ngay</button>
                        <button class="btn btn-outline btn-lg">+ Th√™m v√†o danh s√°ch</button>
                        <button class="btn btn-outline btn-lg" onclick="openShareModal()">üì§ Chia s·∫ª</button>
                    </div>
                    
                    <div class="tabs">
                        <div class="tab active" data-tab="overview">T·ªïng quan</div>
                        <div class="tab" data-tab="episodes">T·∫≠p phim</div>
                        <div class="tab" data-tab="cast">Di·ªÖn vi√™n</div>
                        <div class="tab" data-tab="reviews">ƒê√°nh gi√°</div>
                    </div>
                    
                    <div class="tab-content active" id="overview">
                        <h3>N·ªôi dung phim</h3>
                        <div id="movie-overview-description">
                            <p>ƒêang t·∫£i n·ªôi dung...</p>
                        </div>
                        
                        <h3 style="margin-top: 20px;">Th·ªÉ lo·∫°i</h3>
                        <div class="categories-list" id="movie-category-list" style="justify-content: flex-start; margin-top: 15px;">
                            <!-- Dynamic categories will be injected here -->
                        </div>
                    </div>
                    
                    <div class="tab-content" id="episodes">
                        <h3>Danh s√°ch t·∫≠p phim</h3>
                        <div class="episode-grid">
                           <p>Ch·ª©c nƒÉng ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn.</p>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="cast">
                        <h3>D√†n nh√¢n v·∫≠t & di·ªÖn vi√™n l·ªìng ti·∫øng</h3>
                         <p>Ch·ª©c nƒÉng ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn.</p>
                    </div>
                    
                    <div class="tab-content" id="reviews">
                        <h3>ƒê√°nh gi√° & Nh·∫≠n x√©t</h3>
                        <p>Ch·ª©c nƒÉng ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Video Player Modal -->
    <div class="modal" id="video-player-modal">
        <div class="modal-content" style="max-width: 900px; width: 90%; background-color: #000;">
            <button class="close-btn" onclick="closeModal('video-player-modal')" style="color: white; z-index: 10;">‚úï</button>
            <div style="padding: 56.25% 0 0 0; position: relative;">
                <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: flex; align-items: center; justify-content: center; background-color: #000;">
                    <div style="text-align: center;">
                        <div class="loading-spinner"></div>
                        <p style="color: white; margin-top: 10px;">ƒêang t·∫£i video...</p>                        <!-- Actual video player would go here, this is a placeholder -->
                        <div style="width: 100%; height: 100%; background: #000; display: flex; align-items: center; justify-content: center; color: white;">
                            <div style="text-align: center;">
                                <div style="font-size: 48px; margin-bottom: 10px;">üì∫</div>
                                <p>Video Player Placeholder</p>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; justify-content: space-between; background: rgba(0,0,0,0.5); padding: 10px 20px; border-radius: 5px; margin-top: 10px;">
                            <button class="btn btn-outline" style="color: white;">Play</button>
                            <div style="color: white;">00:00 / 24:30</div>
                            <button class="btn btn-outline" style="color: white;">Full Screen</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Trailer Modal -->
    <div class="modal" id="trailer-modal">
        <div class="modal-content" style="max-width: 800px; width: 90%; background-color: #000;">
            <button class="close-btn" onclick="closeModal('trailer-modal')" style="color: white; z-index: 10;">‚úï</button>
            <div style="padding: 56.25% 0 0 0; position: relative;">
                 <!-- Actual video player (e.g., YouTube iframe) would go here -->
                <iframe style="position:absolute;top:0;left:0;width:100%;height:100%;" 
                        src="https://www.youtube.com/embed/VQGCKykIcqQ" 
                        title="YouTube video player" frameborder="0" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        allowfullscreen>
                </iframe>
                <!-- Fallback if iframe doesn't load or for static display -->
                <!-- 
                <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: flex; align-items: center; justify-content: center; background-color: #000;">
                    <div style="text-align: center;">
                        <img src="/api/placeholder/800/450" alt="Trailer Player Placeholder" style="max-width: 100%; display: block; margin: 0 auto;">
                        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                            <div class="play-btn" style="width: 80px; height: 80px; opacity: 0.9;">‚ñ∂</div>
                        </div>
                    </div>
                </div>
                -->
            </div>
        </div>
    </div>    <!-- Community Discussion Section -->
    <section class="community-section">
        <div class="container">
            <div class="section-title">
                <h2>Th·∫£o lu·∫≠n c·ªông ƒë·ªìng</h2>
            </div>
            <div class="community-container" style="max-width: 800px; margin: 20px auto 0;">
                
                <!-- Comment Form (shown when logged in) -->
                <div id="comment-form" class="comment-form" style="display: none; background: var(--bg-secondary); padding: 20px; border-radius: 10px; margin-bottom: 30px;">
                    <h3 style="margin-bottom: 15px; color: var(--text-color);">Vi·∫øt b√¨nh lu·∫≠n</h3>
                    <textarea id="comment-content" placeholder="Chia s·∫ª suy nghƒ© c·ªßa b·∫°n v·ªÅ b·ªô phim n√†y..." 
                              style="width: 100%; padding: 15px; border-radius: 8px; background-color: var(--bg-color); color: var(--text-color); border: 1px solid var(--light-color); resize: vertical; min-height: 100px; margin-bottom: 15px; box-sizing: border-box;"></textarea>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                        <div class="rating-section" style="display: flex; align-items: center; gap: 10px;">
                            <span style="color: var(--text-secondary);">ƒê√°nh gi√°:</span>
                            <div class="star-rating" style="display: flex; gap: 5px;">
                                <label><input type="radio" name="rating" value="1" style="display: none;"><span style="cursor: pointer; font-size: 20px; color: #ddd;">‚≠ê</span></label>
                                <label><input type="radio" name="rating" value="2" style="display: none;"><span style="cursor: pointer; font-size: 20px; color: #ddd;">‚≠ê</span></label>
                                <label><input type="radio" name="rating" value="3" style="display: none;"><span style="cursor: pointer; font-size: 20px; color: #ddd;">‚≠ê</span></label>
                                <label><input type="radio" name="rating" value="4" style="display: none;"><span style="cursor: pointer; font-size: 20px; color: #ddd;">‚≠ê</span></label>
                                <label><input type="radio" name="rating" value="5" checked style="display: none;"><span style="cursor: pointer; font-size: 20px; color: #ffd700;">‚≠ê</span></label>
                            </div>
                        </div>
                        <button class="submit-comment-btn" style="padding: 10px 20px; background: var(--primary-color); color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: 500;" disabled>
                            ƒêƒÉng b√¨nh lu·∫≠n
                        </button>
                    </div>
                </div>
                
                <!-- Login Prompt (shown when not logged in) -->
                <div id="login-prompt" class="login-prompt" style="display: block; background: var(--bg-secondary); padding: 20px; border-radius: 10px; margin-bottom: 30px; text-align: center;">
                    <p style="color: var(--text-secondary); margin-bottom: 15px;">ƒêƒÉng nh·∫≠p ƒë·ªÉ tham gia th·∫£o lu·∫≠n v√† b√¨nh lu·∫≠n v·ªÅ b·ªô phim n√†y</p>
                    <a href="../login-register/login.html" style="padding: 10px 20px; background: var(--primary-color); color: white; text-decoration: none; border-radius: 5px; display: inline-block;">
                        ƒêƒÉng nh·∫≠p
                    </a>
                </div>
                
                <!-- Comments Loading -->
                <div id="comments-loading" style="display: none; text-align: center; padding: 20px; color: var(--text-secondary);">
                    <div style="display: inline-block; width: 20px; height: 20px; border: 2px solid var(--primary-color); border-radius: 50%; border-top-color: transparent; animation: spin 1s linear infinite; margin-right: 10px;"></div>
                    ƒêang t·∫£i b√¨nh lu·∫≠n...
                </div>
                
                <!-- Comments Container -->
                <div id="comments-container" class="comments-container">
                    <!-- Comments will be loaded here dynamically -->
                </div>
                
            </div>
        </div>
    </section><iframe 
        id="footer-iframe"
        src="../footer.html" 
        style="width: 100%; border: none; min-height: 100px;" 
        onload="adjustIframeHeight(this);"
        title="Footer Information"
        loading="lazy">
      </iframe>

    <!-- Social Sharing Modal -->
    <div id="shareModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Chia s·∫ª phim</h3>
                <span class="close" onclick="closeShareModal()">&times;</span>
            </div>
            <div class="modal-body">
                <p>Chia s·∫ª phim "Demon Slayer" v·ªõi b·∫°n b√®:</p>
                <div class="share-buttons">
                    <button class="share-btn facebook" onclick="shareToFacebook()">
                        <span>üìò</span> Facebook
                    </button>
                    <button class="share-btn twitter" onclick="shareToTwitter()">
                        <span>üê¶</span> Twitter
                    </button>
                    <button class="share-btn telegram" onclick="shareToTelegram()">
                        <span>‚úàÔ∏è</span> Telegram
                    </button>
                    <button class="share-btn copy-link" onclick="copyShareLink()">
                        <span>üîó</span> Sao ch√©p link
                    </button>
                </div>
                <div class="referral-section">
                    <h4>M·ªùi b·∫°n b√® ƒëƒÉng k√Ω</h4>
                    <p>Nh·∫≠n th√†nh t·ª±u ƒë·∫∑c bi·ªát khi m·ªùi b·∫°n b√® tham gia!</p>
                    <div class="referral-link-container">
                        <input type="text" id="referralLink" readonly placeholder="ƒêang t·∫°o link m·ªùi...">
                        <button onclick="copyReferralLink()">üìã Sao ch√©p</button>
                    </div>
                </div>
            </div>
        </div>
    </div>    <script src="../js/shared-api.js"></script>
    <script src="./script.js"></script>
    <script>
        // Header height adjustment - simplified for inline header
        document.addEventListener('DOMContentLoaded', function() {
            const heroSection = document.querySelector('.movie-detail-hero');
            
            // Set margin to fixed header height since we're using inline header (not iframe)
            if (heroSection) {
                heroSection.style.marginTop = '80px'; // Fixed header height from header.css
                console.log('‚úÖ Header margin set to 80px for inline header');
            }
        });
          // === DEBUG: For testing comments without login page ===
        // Option 1 (recommended): Create real test user and login:
        // createTestUserAndLogin()
        // 
        // Option 2: Simple simulation (might fail if user doesn't exist):
        // simulateLogin()
        // 
        // To logout: simulateLogout()
        // ========================================================
        // Navigation functions for header
        window.navigateToHome = function() {
            window.location.href = '../index.html';
        };
        
        window.smartNavigate = function(section) {
            switch(section) {
                case 'top':
                    window.location.href = '../index.html';
                    break;
                case 'movies':
                    window.location.href = '../index.html#movies';
                    break;
                case 'achievements':
                    window.location.href = '../index.html#achievements';
                    break;
                case 'category':
                    window.location.href = '../index.html#category';
                    break;
                case 'live':
                    window.location.href = '../index.html#live';
                    break;
                default:
                    window.location.href = '../index.html';
            }
        };
          // User menu functions
        window.viewProfile = function() {
            window.location.href = '../profile/profile.html';
        };
        
        window.viewBookmarks = function() {
            alert('Ch·ª©c nƒÉng ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn');
        };
        
        window.viewHistory = function() {
            alert('Ch·ª©c nƒÉng ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn');
        };
        
        window.logout = function() {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒëƒÉng xu·∫•t?')) {
                localStorage.removeItem('currentUser');
                localStorage.removeItem('authToken');
                localStorage.removeItem('userData');
                window.location.href = '../index.html';
            }
        };
        
        // User dropdown functionality
        document.addEventListener('DOMContentLoaded', function() {
            const userInfoDisplay = document.getElementById('userInfoDisplay');
            const userDropdown = document.getElementById('userDropdown');
            
            if (userInfoDisplay && userDropdown) {
                userInfoDisplay.addEventListener('click', function(e) {
                    e.stopPropagation();
                    
                    // Toggle dropdown visibility
                    if (userDropdown.style.display === 'none' || !userDropdown.style.display) {
                        userDropdown.style.display = 'block';
                    } else {
                        userDropdown.style.display = 'none';
                    }
                });
                
                // Close dropdown when clicking outside
                document.addEventListener('click', function(e) {
                    if (!userInfoDisplay.contains(e.target) && !userDropdown.contains(e.target)) {
                        userDropdown.style.display = 'none';
                    }
                });
            }
        });// Notification functions
        window.markAllNotificationsRead = function() {
            console.log('Marking all notifications as read');
            // Implementation would go here
        };
        
        // Notification Bell functionality
        document.addEventListener('DOMContentLoaded', function() {
            const notificationBell = document.getElementById('notificationBellDisplay');
            const notificationDropdown = document.getElementById('notificationDropdown');
            
            if (notificationBell && notificationDropdown) {
                notificationBell.addEventListener('click', function(e) {
                    e.stopPropagation();
                    
                    // Toggle dropdown visibility
                    if (notificationDropdown.classList.contains('notification-dropdown-hidden')) {
                        notificationDropdown.classList.remove('notification-dropdown-hidden');
                        
                        // Load notifications if not already loaded
                        loadNotifications();
                    } else {
                        notificationDropdown.classList.add('notification-dropdown-hidden');
                    }
                });
                
                // Close dropdown when clicking outside
                document.addEventListener('click', function(e) {
                    if (!notificationBell.contains(e.target) && !notificationDropdown.contains(e.target)) {
                        notificationDropdown.classList.add('notification-dropdown-hidden');
                    }
                });
            }
        });
        
        function loadNotifications() {
            const notificationList = document.getElementById('notificationList');
            const notificationCount = document.getElementById('notificationCount');
            const notificationBadge = document.getElementById('notificationBadge');
            
            if (notificationList) {
                // Mock notifications data - in real app, this would be from API
                const notifications = [
                    {
                        id: 1,
                        title: 'Phim m·ªõi ƒë∆∞·ª£c th√™m',
                        message: 'Dragon Ball Super: Broly ƒë√£ ƒë∆∞·ª£c th√™m v√†o th∆∞ vi·ªán',
                        time: '2 gi·ªù tr∆∞·ªõc',
                        read: false
                    },
                    {
                        id: 2,
                        title: 'T·∫≠p m·ªõi ƒë√£ ra',
                        message: 'One Piece t·∫≠p 1000 ƒë√£ c√≥ s·∫µn',
                        time: '1 ng√†y tr∆∞·ªõc',
                        read: true
                    }
                ];
                
                if (notifications.length === 0) {
                    notificationList.innerHTML = `
                        <div style="padding: 20px; text-align: center; color: #999;">
                            <i class="fas fa-bell-slash" style="font-size: 24px; margin-bottom: 10px; opacity: 0.5;"></i>
                            <p>Kh√¥ng c√≥ th√¥ng b√°o n√†o</p>
                        </div>
                    `;
                } else {
                    notificationList.innerHTML = notifications.map(notification => `
                        <div class="notification-item" style="padding: 12px 16px; border-bottom: 1px solid #eee; ${!notification.read ? 'background: #f0f8ff;' : ''} cursor: pointer;" onclick="markNotificationRead(${notification.id})">
                            <div style="display: flex; justify-content: space-between; align-items: flex-start; gap: 10px;">
                                <div style="flex: 1;">
                                    <div style="font-weight: ${!notification.read ? '600' : '500'}; color: #333; margin-bottom: 4px; font-size: 14px;">${notification.title}</div>
                                    <div style="color: #666; font-size: 13px; line-height: 1.4; margin-bottom: 4px;">${notification.message}</div>
                                    <div style="color: #999; font-size: 12px;">${notification.time}</div>
                                </div>
                                ${!notification.read ? '<div style="width: 8px; height: 8px; background: #3498db; border-radius: 50%; margin-top: 4px;"></div>' : ''}
                            </div>
                        </div>
                    `).join('');
                }
                
                // Update notification count
                const unreadCount = notifications.filter(n => !n.read).length;
                if (notificationCount) {
                    notificationCount.textContent = unreadCount;
                }
                if (notificationBadge) {
                    if (unreadCount > 0) {
                        notificationBadge.textContent = unreadCount;
                        notificationBadge.style.display = 'inline-block';
                    } else {
                        notificationBadge.style.display = 'none';
                    }
                }
            }
        }
        
        function markNotificationRead(notificationId) {
            console.log('Marking notification read:', notificationId);
            // In real app, would make API call to mark as read
            // Reload notifications to update UI
            setTimeout(() => {
                loadNotifications();
            }, 100);
        }
          // Voice Search functionality
        document.addEventListener('DOMContentLoaded', function() {
            const voiceBtn = document.getElementById('voiceBtn');
            const searchInput = document.getElementById('searchInput');
            const searchBtn = document.getElementById('searchBtn');
            const searchForm = document.getElementById('searchForm');
            
            if (voiceBtn && searchInput) {
                voiceBtn.addEventListener('click', function() {
                    startVoiceSearch();
                });
            }
            
            // Search form functionality
            if (searchForm) {
                searchForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    performSearch();
                });
            }
            
            if (searchBtn) {
                searchBtn.addEventListener('click', function() {
                    performSearch();
                });
            }
            
            // Search input enter key
            if (searchInput) {
                searchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        performSearch();
                    }
                });
            }
        });
        
        function performSearch() {
            const searchInput = document.getElementById('searchInput');
            const query = searchInput.value.trim();
            
            if (!query) {
                showNotification('Vui l√≤ng nh·∫≠p t·ª´ kh√≥a t√¨m ki·∫øm', 'warning');
                return;
            }
            
            // Redirect to search results page or index with search params
            const searchUrl = `../index.html?search=${encodeURIComponent(query)}`;
            window.location.href = searchUrl;
        }
        
        function startVoiceSearch() {
            // Check if browser supports speech recognition
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                showNotification('Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ t√¨m ki·∫øm b·∫±ng gi·ªçng n√≥i', 'warning');
                return;
            }
            
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            const recognition = new SpeechRecognition();
            
            recognition.lang = 'vi-VN';
            recognition.continuous = false;
            recognition.interimResults = false;
            
            const voiceBtn = document.getElementById('voiceBtn');
            const searchInput = document.getElementById('searchInput');
            
            // Update button to show recording state
            voiceBtn.innerHTML = '<span style="color: #e74c3c;">üé§</span>';
            voiceBtn.style.background = 'rgba(231, 76, 60, 0.1)';
            
            recognition.onstart = function() {
                console.log('Voice recognition started');
                showNotification('ƒêang l·∫Øng nghe... H√£y n√≥i t·ª´ kh√≥a t√¨m ki·∫øm', 'info');
            };
            
            recognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript;
                console.log('Voice recognition result:', transcript);
                
                // Put result in search input
                searchInput.value = transcript;
                
                // Trigger search
                showNotification(`ƒê√£ nh·∫≠n di·ªán: "${transcript}"`, 'success');
                
                // You can trigger search here
                // performSearch(transcript);
            };
            
            recognition.onerror = function(event) {
                console.error('Voice recognition error:', event.error);
                let errorMessage = 'L·ªói nh·∫≠n di·ªán gi·ªçng n√≥i';
                
                switch(event.error) {
                    case 'no-speech':
                        errorMessage = 'Kh√¥ng ph√°t hi·ªán gi·ªçng n√≥i';
                        break;
                    case 'network':
                        errorMessage = 'L·ªói k·∫øt n·ªëi m·∫°ng';
                        break;
                    case 'not-allowed':
                        errorMessage = 'Vui l√≤ng cho ph√©p quy·ªÅn truy c·∫≠p microphone';
                        break;
                }
                
                showNotification(errorMessage, 'error');
            };
            
            recognition.onend = function() {
                // Reset button state
                voiceBtn.innerHTML = '<span>üé§</span>';
                voiceBtn.style.background = '';
                console.log('Voice recognition ended');
            };
            
            // Start recognition
            try {
                recognition.start();
            } catch (error) {
                console.error('Failed to start voice recognition:', error);
                showNotification('Kh√¥ng th·ªÉ kh·ªüi ƒë·ªông t√¨m ki·∫øm b·∫±ng gi·ªçng n√≥i', 'error');
                
                // Reset button state
                voiceBtn.innerHTML = '<span>üé§</span>';
                voiceBtn.style.background = '';
            }
        }
        
        // Star rating functionality
        document.addEventListener('DOMContentLoaded', function() {
            setupStarRating();
        });
        
        function setupStarRating() {
            const starRating = document.querySelector('.star-rating');
            if (!starRating) return;
            
            const labels = starRating.querySelectorAll('label');
            const inputs = starRating.querySelectorAll('input[type="radio"]');
            
            labels.forEach((label, index) => {
                label.addEventListener('click', function() {
                    const rating = index + 1;
                    
                    // Update input
                    inputs[index].checked = true;
                    
                    // Update visual stars
                    labels.forEach((l, i) => {
                        const span = l.querySelector('span');
                        if (i <= index) {
                            span.style.color = '#ffd700';
                        } else {
                            span.style.color = '#ddd';
                        }
                    });
                });
                
                label.addEventListener('mouseenter', function() {
                    labels.forEach((l, i) => {
                        const span = l.querySelector('span');
                        if (i <= index) {
                            span.style.color = '#ffd700';
                        } else {
                            span.style.color = '#ddd';
                        }
                    });
                });
            });
            
            starRating.addEventListener('mouseleave', function() {
                const checkedInput = starRating.querySelector('input:checked');
                const checkedIndex = checkedInput ? Array.from(inputs).indexOf(checkedInput) : 4; // Default to 5 stars
                
                labels.forEach((l, i) => {
                    const span = l.querySelector('span');
                    if (i <= checkedIndex) {
                        span.style.color = '#ffd700';
                    } else {
                        span.style.color = '#ddd';
                    }
                });
            });
        }
    </script>
</body>
</html>